(function(b){var a=false;b.ShillaCheckout={options:{contextPath:""},message:{PA004:"请按“更改护照信息”按钮后前往修改护照信息",PA005:"您所输入的电话号码并非有效号码",PA006:"手机号码无法输入超过11码以上",PA009:"如果经过北京首都国际机场的话，超过100ml的液体类商品禁止带进机内。\n购买液体类商品时，一定要托运小件行李。\n在其他机场换乘的时候，如带液体或凝胶类等，请您准备好透明塑料。\n请您参考限制携带物品。",PA010:"已经超过4000字，无法再输入",PA013:"请输入回国(韩国出境)日期",PA014:"请输入从韩国出境之地点",PA015:"请输入航班号码",PA016:"请输入正确的航班号码",PA017:"出国时(国际航班)可进行购买. 国内旅行时无法(金海, 济州岛, 庆州等 )购买.\n请选择目的地",PA018:"出国时(国际航班)可进行购买. 国内时无法(金海, 济州岛, 庆州等 )进行购买.\n请选择目的地",PA019:"请输入航班号码(船班号码)长至少5个字符",PA020:"将此次输入的护照信息变更登录至会员信息. 您要修改吗?",PA021:"护照信息更改成功",PA023:"请输入护照号码",PA024:"请输入您的护照有效日期",PA025:"确定要登录此信息吗?",PA026:"航班名不正确，请输入至少3个数字",PA027:"请输入航空公司代码。",PA029:"请输入正确的船班名",PA030:"请选择出国时间",PA050:"只可使用总订购金额30%以内的积分金额。",PA101:"只能输入数字。",PA102:"请选择您要付款的方式。",PA103:"请输入回国(韩国出境)日期, 从韩国出境之地点, 航班号码(选择船班名), 航空公司代码, 到达地点。",PA104:"对不起，本支付系统不支持火狐浏览器。\n请使用其他浏览器。",PA105:"以韩国出境日期 为准d日以内可顶购。",PA106:"这不是有效的护照信息。",PA107:"您所输入的护照号码已经注册过会员。\n若您所输入的护照号码无误，请与客服中心联络。(400-090-8666)",PA108:"不可输入标点符号",PA109:"您输入的信息与航班信息不一致。\n如您不知道航班信息，点击查询航班按钮就可以搜索航班信息。",PA110:"非常抱歉！\n苹果浏览器上不可以银联付款。\n请您选择另外付款方式或使用另外浏览器(IE等)。",PA901:"您要以您的国家货币为单位进行结算吗?若选择取消将以韩币(￦)为准替您结算。",PA902:"此笔交易正在进行中。",PA903:"您不能输入在过去的某个日期。",PA904:"若出境信息不准确的话，有可能无法取货，请您注意。请注意，以上出国信息不正确的状况下无法领取商品。您确定现在要结算了吗?"},divMessage:{1:"不可购买液体类、凝胶类商品。请再次确认所订购的商品",2:"最终目的地为美国、澳大利亚的情况下，不可购买液体类、凝胶类商品。请再次确认所订购的商品。",3:"不可购买液体类、凝胶类商品。请再次确认所订购的商品",4:"不可购买液体类、凝胶类商品。请再次确认所订购的商品",5:"不可购买液体类、凝胶类商品。请再次确认所订购的商品",6:"不可购买液体类、凝胶类商品。请再次确认所订购的商品",8:"最终目的地为美国、澳大利亚的情况下，不可购买液体类、凝胶类商品。请再次确认所订购的商品。",9:"不可购买液体类、凝胶类商品。请再次确认所订购的商品",10:"以托运方式处理可购买液体类、凝胶类产品",11:"不可购买液体类、凝胶类商品。请再次确认所订购的商品",12:"不可购买液体类、凝胶类商品。请再次确认所订购的商品",13:"不可购买液体类、凝胶类商品。请再次确认所订购的商品",14:"不可购买液体类、凝胶类商品。请再次确认所订购的商品"},paywayLabel:{1:"韩国信用卡",2:"财付通(Tenpay)",4:"微信支付",6:"中国银联卡(Unionpay)",16:"海外信用卡",22:"银联信用卡",23:"PayPal",27:"Alipay",30:"Alipay",31:"银联快捷支付",45:"翼支付",46:"微信支付",51:"Alipay",54:"微信支付(公众号)",61:"微信支付"},url:{flightInfoIncheon:"/checkout/checkoutFlightSchedule/incheon",flightInfo:"/checkout/checkoutFlightSchedule",depatureInfo:"/checkout/checkoutDepartureInfo",couponList:"/checkout/coupon/couponList",passportEdit:"/checkout/checkoutPassportEditPopup",updatePassport:"/checkout/updatePassport",easypayRequest:"/checkout/easypay/paymentRequest",easypayPayment:"/checkout/easypay/payment",nocardPayment:"/checkout/payment",upopPrePayment:"/checkout/easypay/upopPrePayment",prePayment:"/checkout/eximbay/prePayment",prePaymentAlipay:"/checkout/alipay/prePayment",alipayPaymentRequest:"/checkout/alipay/paymentRequest",kcpRegRequest:"/checkout/kcp/reg/request",kcpPayRequest:"/checkout/kcp/pay/request",alliexPrePayment:"/checkout/alliex/prePayment",smartroPrePayment:"/checkout/smartro/prePayment",prePaymentAlipayKicc:"/checkout/alipay/kicc/prePayment",alipayPaymentRequestKicc:"/checkout/alipay/kicc/paymentRequest",distributeOrderUrl:"/checkout/ajax/distribute",tnuPrePayment:"/checkout/tnu/prePayment",easypayAlipayPaymentMethod:"/checkout/easypay/alipayplus/paymentMethod",easypayAlipayPrePaymentRequest:"/checkout/easypay/alipayplus/prePayment",easypayAlipayPaymentRequest:"/checkout/easypay/alipayplus/paymentRequest"},getMessage:function(c){var d=b.ShillaCheckout.message[c];return d},getDivMessage:function(c){var d=b.ShillaCheckout.divMessage[c];return d},getUrl:function(d){var c=this.options.contextPath+b.ShillaCheckout.url[d];return c},getPaywayLabel:function(d){var c=b.ShillaCheckout.paywayLabel[d];return c},initCheckOut:function(d){this.options=b.extend({contextPath:""},d||{});var c=b(":input:radio[name=transit]:checked").val();b(":input:hidden[name=directYn]").val(c);b(document).on("change","select[name=depPlaceCode1]",function(){b.ShillaCheckout.depPlaceCodeChange({obj:b(this)})});b(document).on("change","select[name=internationalTelNumber]",function(){if(b(this).val()=="etc"){b("#chinaMobilePhone").attr("placeholder","请包括输入国家代码")}else{b("#chinaMobilePhone").attr("placeholder","")}});b(document).on("change","#time_set1",function(){if(b(this).val()){b(".time_tip").html("");if(b(this).val().indexOf(":")>-1){var f=b(this).val().split(":");var e=[];e.push(f[0]+"点 ");e.push(f[1]+"分 出发")}b(".time_tip").html(e.join(""));b(".time_tip").show();b(":input:hidden[name=depTime]").val(f[0]+f[1])}});b(document).on("change","#depHour",function(){b.ShillaCheckout.displayStartTime()});b(document).on("change","#depMinute",function(){b.ShillaCheckout.displayStartTime()});b(document).on("blur keyup","#date_set1",function(){if(b(this).val()){var g=new Date();var f=new Date();var h=b(this).val().substring(0,4);var j=b(this).val().substring(5,7);var e=b(this).val().substring(8,10);g.setFullYear(h,parseInt(j)-1,e);if(f.getTime()>g.getTime()){alert(b.ShillaCheckout.getMessage("PA903"));b(this).val("");return false}var i=b(this).val().replace(/\-/g,"");b(":input:hidden[name=depDate]").val(i);b("#displayDepDate").text(i)}});b(document).on("change","#date_year",function(){if(b(this).val()&&b("#date_month").val()&&b("#date_day").val()){var g=new Date();var f=new Date();var h=b(this).val();var j=b("#date_month").val();var e=b("#date_day").val();g.setFullYear(h,parseInt(j)-1,e);if(f.getTime()>g.getTime()){alert(b.ShillaCheckout.getMessage("PA903"));b(this).val("");return false}var i=h+j+e;b(":input:hidden[name=depDate]").val(i);b("#displayDepDate").text(i)}});b(document).on("change","#date_month",function(){if(b(this).val()&&b("#date_year").val()&&b("#date_day").val()){var g=new Date();var f=new Date();var h=b("#date_year").val();var j=b(this).val();var e=b("#date_day").val();g.setFullYear(h,parseInt(j)-1,e);if(f.getTime()>g.getTime()){alert(b.ShillaCheckout.getMessage("PA903"));b(this).val("");return false}var i=h+j+e;b(":input:hidden[name=depDate]").val(i);b("#displayDepDate").text(i)}});b(document).on("change","#date_day",function(){if(b(this).val()&&b("#date_month").val()&&b("#date_year").val()){var g=new Date();var f=new Date();var h=b("#date_year").val();var j=b("#date_month").val();var e=b(this).val();g.setFullYear(h,parseInt(j)-1,e);if(f.getTime()>g.getTime()){alert(b.ShillaCheckout.getMessage("PA903"));b(this).val("");return false}var i=h+j+e;b(":input:hidden[name=depDate]").val(i);b("#displayDepDate").text(i)}});b(document).on("touchstart click",".ico_search",function(){b.ShillaCheckout.searchFlightOrShip()});b(document).on("touchstart click",":input:radio[name=transit]",function(g){var f=b(":input:radio[name=transit]:checked").val();b(":input:hidden[name=directYn]").val(f);b(":input:hidden[name=viaPlaceCode]").val("");if(b(this).val()=="N"){b("#viaPlaceCode").show()}else{b("#viaPlaceCode").hide()}});b(document).on("click","#airport1",function(){b.ShillaCheckout.searchFlightOrShip()});b(document).on("change","#viaPlaceCode",function(){if(b("#airport").val()==""){alert(b.ShillaCheckout.getMessage("PA014"));b(this).val("").attr("selected","selected");return false}var e=b("select[name=date_year]").val()+b("select[name=date_month]").val()+b("select[name=date_day]").val();if(e==""||e.length<8){e=""}if(e==""||b("#time_set1").val()==""){alert(b.ShillaCheckout.getMessage("PA013"));b(this).val("").attr("selected","selected");return false}if(b("#airport1").val()==""){alert(b.ShillaCheckout.getMessage("PA015"));b(this).val("").attr("selected","selected");return false}b(":input:hidden[name=viaPlaceCode]").val(b(this).val())});b(document).on("change","#arrivPlaceCode1",function(){b(":input:hidden[name=arrivPlaceCode]").val(b(this).val())});b(document).on("touchstart click","#orderableTime",function(){popOpen(b("#layer-orderabletime"))});b(document).on("touchstart click","#limitProducts",function(){popOpen(b("#layer-airplane"))});b(document).on("touchstart click",".close",function(){popClose(b("#layer-searchschedule"))});b(document).on("touchstart click",".btn_area > .btn_red",function(){popClose(b("#layer-orderabletime"))});b(document).on("touchstart click","#myDepatureLayerPopup",function(){var e=b.ShillaCheckout.getUrl("depatureInfo");b.ShillaCheckout.getMyDepatureInfo({url:e,callback:function(f){if(f){b("#layer-myinfoabroad").html(f);popOpen(b("#layer-myinfoabroad"))}}})});b(document).on("keydown","#message_inp",function(){var f=b(this).val();var g=4000;var e=b.ShillaCheckout.strLengthCheck(f,g);if(e==false){alert(b.ShillaCheckout.getMessage("PA010"));b(this).val("");return false}});b(document).on("touchstart click","#payment",function(h){var g=b("#orderForm");var f=b(g).find("input[name=captchaBot]").val();if(f=="true"){validate_captcha_chk()}else{b.ShillaSubmit.submitHandler(g)}h.preventDefault();return false});b.ShillaCheckout.initDiscountSection();b.ShillaCheckout.initCouponSection();b.ShillaCheckout.initUserInfoSection();b.ShillaCheckout.initPaymentMethodSection();b(document).on("change","#korCreditCard",function(){if(b(this).val()!=""){MiniCalculator.expectedSaveClubMileage()}});b(document).on("change","#intrCreditCard",function(){if(b(this).val()!=""){MiniCalculator.expectedSaveClubMileage()}});b(document).on("change","#intrKrpCreditCard",function(){if(b(this).val()!=""){MiniCalculator.expectedSaveClubMileage()}});if(b("input:radio[name=selPayCardChk]:checked").data("paywaycode")=="71"&&b("#walletBrandName option").length<=1){b.ShillaSubmit.easypayAlipayPaymentMethod()}},displayStartTime:function(){var c="";if(b.ShillaCheckout.getHour()!=""){var d=parseInt(b("#depHour option:selected").val());c=b.ShillaCheckout.getHour()+b.ShillaCheckout.getMinute();if(d<=12){c="上午 "+c}else{c="下午 "+c}}else{c=b.ShillaCheckout.getMinute()}b("#departureTime").html(c)},getHour:function(){var c=b("#depHour option:selected").val();if(c==""){return""}return c+"点"},getMinute:function(){var c=b("#depMinute option:selected").val();if(c==""){return""}return c+"分 出发"},initCouponSection:function(){b(document).on("touchstart click","#coupon",function(){b.ShillaCheckout.getCouponList({callback:function(c){if(c){b("#layer-coupon").html(c);popOpen(b("#layer-coupon"))}}})})},initDiscountSection:function(){b(document).on("touchstart click","#totalSavedMileageUsedY, #totalSavedMileageUsedN",function(){var r;var s=b(this).data();var q=b(this).val()=="Y"?true:false;if(q){r=s.applySavedMileage}else{r=0}MiniCalculator.applySavedMileage(r)});b(document).on("change","select[name=additionalMileageId]",function(){var q;if(b(this).val()!=""){var r=b(this).children("option:selected").data();q=parseFloat(r.amount)}else{q=0}MiniCalculator.applyAdditionalMileage(q)});b(document).on("blur","#usedMobileMileage",function(){if(b(this).val()!=""&&b.isNumeric(b(this).val())){var r=b(this).val();var q=b("#totalUsedMobileMileage").data();r=parseFloat(r);MiniCalculator.applyMobileMileage(r)}else{alert("只能输入数字。");b(this).val(0);return false}});b(document).on("touchstart click","#totalUsedMobileMileage",function(){var s=b(this).data();var q=b(this).is(":checked");var r;if(q){r=s.availableMileage;MiniCalculator.applyMobileMileage(r,true)}else{MiniCalculator.applyMobileMileage(0)}});b(document).on("blur","#usedUsdVoucherMileage",function(){b.ShillaCheckout.validateUnlimiMileageVal(b(this));var q=b(this).val();var r=b("#totalUsedUsdVoucherMileage").data();var s=false;q=parseFloat(q);totalUsdVoucherMileage=parseFloat(r.availableVouchermileage);if(q>totalUsdVoucherMileage){alert("보유한 商品券转换积分 보다 큰 금액 입니다.");b(this).val(totalUsdVoucherMileage);b("input:checkbox[id=totalUsedUsdVoucherMileage]").prop("checked",true);s=true}else{if(q==totalUsdVoucherMileage){b("input:checkbox[id=totalUsedUsdVoucherMileage]").prop("checked",true);s=true}else{if(q<totalUsdVoucherMileage){b("input:checkbox[id=totalUsedUsdVoucherMileage]").prop("checked",false);s=false}}}MiniCalculator.applyUsdVoucherMileage(q,s)});b(document).on("touchstart click","#totalUsedUsdVoucherMileage",function(){var s=b(this).data();var q=b(this).is(":checked");var r;if(q){r=s.availableVouchermileage}else{r=0}MiniCalculator.applyUsdVoucherMileage(r,true)});b(document).on("blur","#usedVoucherMileage",function(){if(b(this).val()!=""&&b.isNumeric(b(this).val())){var q=b(this).val();var r=b("#totalUsedVoucherMileage").data();var s=false;q=parseFloat(q);totalVoucherMileage=parseFloat(r.availableVouchermileage);if(q>totalVoucherMileage){alert("보유한 商品券转换积分 보다 큰 금액 입니다.");b(this).val(totalVoucherMileage);b("input:checkbox[id=totalUsedVoucherMileage]").prop("checked",true);s=true}else{if(q==totalVoucherMileage){b("input:checkbox[id=totalUsedVoucherMileage]").prop("checked",true);s=true}else{if(q<totalVoucherMileage){b("input:checkbox[id=totalUsedVoucherMileage]").prop("checked",false);s=false}}}MiniCalculator.applyVoucherMileage(q,s)}else{alert("숫자만 입력 가능합니다.");b(this).val(0);return false}});b(document).on("touchstart click","#totalUsedVoucherMileage",function(){var s=b(this).data();var q=b(this).is(":checked");var r;if(q){r=s.availableVouchermileage}else{r=0}MiniCalculator.applyVoucherMileage(r,true)});b(document).on("touchstart click","#maxUnlimitMileage",function(){var q=b(this).is(":checked");var r;if(q){r=b("#availableGeneralUnlimtMileage1").val();MiniCalculator.applyMileage(r,true)}else{MiniCalculator.applyMileage(0)}});b(document).on("focusout","#totalUsedUnlimitMileage",function(){b.ShillaCheckout.validateUnlimiMileageVal(b(this));var q=b.ShillaCheckout.validationUnlimitMileage(b(this));if(!q){return false}MiniCalculator.applyMileage(b(this).val())});b(document).on("change","select[name=duplicateMileageIds]",function(){var q;if(b(this).val()){var r=b("select[name=duplicateMileageIds] option:selected").data();q=r.amount}else{q=0}MiniCalculator.applyDuplicateMileage(q)});var l=0;var f=false;b(document).on("click","#searchSReward",function(s){s.preventDefault();if(ACC.customer.data.isRestrictedUseMileage){alert("该账号仅限使用立即折扣积分");return}if(f){return}f=true;var r=b("#orderForm");if(r.length==0){r=b("#checkoutForm")}var q;if(location.href.indexOf(ACC.cart.data.cartPageUrl)!=-1){q=contextPath+"/cart/point/srewardinfo"}else{q=contextPath+"/checkout/point/srewardinfo"}AjaxUtil.post(q,r.serialize(),function(t){f=false;if(!!t.errorMessage){MiniCalculator.data.availableSReward=0;MiniCalculator.data.availableSRewardPoint=0;b("#totalUsedSReward2").attr("disabled",false);b("#useAllSReward").attr("disabled",false);b("label[for=useAllSReward]").removeClass("lable_disabled");b("#sRewardInfo").text("(可用  0P)");b("#searchSReward").hide();b("#sRewardInfo").show();return false}l=MiniCalculator.toWonAmt(t.availablePoint);b("#totalUsedSReward2").attr("disabled",false);b("#useAllSReward").attr("disabled",false);b("label[for=useAllSReward]").removeClass("lable_disabled");b("#sRewardInfo").text("(可用 "+MiniCalculator.convertToFomat(t.availablePoint,MiniCalculator.priceFormat.KRWWithoutSymbol)+"P)");b("#searchSReward").hide();b("#sRewardInfo").show();MiniCalculator.data.availableSReward=l;MiniCalculator.data.availableSRewardPoint=t.availablePoint},function(v,t,u){f=false;alert("서버와의 통신에 장애가 발생하였습니다.")})});var e=false;b("#searchSpecialReward").on("click",function(t){t.preventDefault();if(ACC.customer.data.isRestrictedUseMileage){alert("该账号仅限使用立即折扣积分");return}if(e){return}e=true;var s=b("#orderForm");if(s.length==0){s=b("#checkoutForm")}var q;if(location.href.indexOf(ACC.cart.data.cartPageUrl)!=-1){q=contextPath+"/cart/point/onlineSrewardInfo"}else{q=contextPath+"/checkout/point/onlineSrewardInfo"}var r=b("#searchSpecialReward").data("search");if(r==0){AjaxUtil.post(q,s.serialize(),function(u){e=false;if(!!u.errorMessage){e=false;b("#specialRewardIds").attr("disabled",false);b("#usedOnlineReward").attr("disabled",false);b("#totalUsedOnlineReward").attr("disabled",false);b("label[for=totalUsedOnlineReward]").removeClass("lable_disabled");b("#useAvailableOnlineReward").text("(可用 "+MiniCalculator.convertToFomat((MiniCalculator.data.availableSClubMileage+MiniCalculator.data.availableSClubEventMileage)*1000,MiniCalculator.priceFormat.KRWWithoutSymbol)+"P)");b("#searchSpecialReward").hide();return false}b("#specialRewardIds").attr("disabled",false);b.each(u.specialReward,function(v){b("#specialRewardIds").append("<option value='"+u.specialReward[v].offrId+"' data-offrid='"+u.specialReward[v].offrId+"' data-offrubmg='"+u.specialReward[v].offrUbMg+"' data-offrpmdt='"+u.specialReward[v].offrPmDt+"'data-offrPmNo='"+u.specialReward[v].offrPmNo+"' >"+u.specialReward[v].offrNm+" : "+u.specialReward[v].offrUbMg+"P</option>")})},function(w,u,v){e=false;alert("서버와의 통신에 장애가 발생하였습니다.")})}e=false;b("#usedOnlineReward").attr("disabled",false);b("#totalUsedOnlineReward").attr("disabled",false);b("label[for=totalUsedOnlineReward]").removeClass("lable_disabled");b("#useAvailableOnlineReward").text("(可用 "+MiniCalculator.convertToFomat((MiniCalculator.data.availableSClubMileage+MiniCalculator.data.availableSClubEventMileage)*1000,MiniCalculator.priceFormat.KRWWithoutSymbol)+"P)");b("#searchSpecialReward").hide()});b(document).on("change","select[name=limitMileageIds]",function(){MiniCalculator.applyLimitMileage(b.ShillaCheckout.getLimitMileageAmount(),b.ShillaCheckout.getLimitAllianceMileageAmount(),this)});b(document).on("change","select[name=limitAllianceMileageIds]",function(){MiniCalculator.applyLimitAllianceMileage(b.ShillaCheckout.getLimitMileageAmount(),b.ShillaCheckout.getLimitAllianceMileageAmount(),this)});b(document).on("blur","#usedClubMileage",function(){if(b(this).val()!=""&&b.isNumeric(b(this).val())){var r=b(this).val();var q=b("#totalUsedClubMileage").data();r=parseFloat(r);MiniCalculator.applyClubMileage(r)}else{alert("只能输入数字。");b(this).val(0);return false}});b(document).on("blur","#usedOnlineReward",function(){if(b(this).val()!=""&&b.isNumeric(b(this).val())){var r=b(this).val();var q=b("#totalUsedOnlineReward").data();r=parseFloat(r);MiniCalculator.applyClubMileage(r)}else{alert("只能输入数字。");b(this).val(0);return false}});b(document).on("touchstart click","#totalUsedClubMileage",function(){var s=b(this).data();var q=b(this).is(":checked");var r;if(q){r=s.availableClubmileage;MiniCalculator.applyClubMileage(r,true)}else{MiniCalculator.applyClubMileage(0)}});b(document).on("touchstart click","#totalUsedOnlineReward",function(){var s=b(this).data();var q=b(this).is(":checked");var r;if(q){r=s.availableClubmileage;MiniCalculator.applyClubMileage(r,true)}else{MiniCalculator.applyClubMileage(0)}});var c=b("#totalSavedMileageUsedY");if(c.length>0){if(parseFloat(c.data().applySavedMileage)>0){c.attr("checked","checked");mileage=c.data().applySavedMileage;MiniCalculator.applySavedMileage(mileage)}}var k=b("#availableEventMileage");if(k.length>0){if(parseFloat(k.data().applyUsedEventMileage)>0){b("#availableEventMileage").attr("checked","checked");MiniCalculator.applyEventMileage()}}var o=b("select[name=limitMileageIds]");if(o.length>0){o=o.data().applyLimitMileageid;if(o!=""){b("select[name=limitMileageIds]").val(o);b("select[name=limitMileageIds]").change()}}var i=b("select[name=limitAllianceMileageIds]");if(i.length>0){i=i.data().applyLimitAllianceMileageid;if(i!=""){b("select[name=limitAllianceMileageIds]").val(i);b("select[name=limitAllianceMileageIds]").change()}}var g=b("#totalUsedUnlimitMileage");if(g.length>0){g=g.data().applyUnlimitMileage;if(parseFloat(g)>0){MiniCalculator.applyMileage(g)}}var d=b("select[name=additionalMileageId]");if(d.length>0){d=d.data().applyAdditionalMileageid;if(d!=""){b("select[name=additionalMileageId]").val(d);b("select[name=additionalMileageId]").change()}}var j=b("#usedMobileMileage");if(j.length>0){j=j.data().applyMobileMileage;if(parseFloat(j)>0){MiniCalculator.applyMobileMileage(j)}}var n=b("#usedUsdVoucherMileage");if(n.length>0){n=n.data().applyVoucherMileage;if(parseFloat(n)>0){MiniCalculator.applyUsdVoucherMileage(n)}}var p=b("#usedVoucherMileage");if(p.length>0){p=p.data().applyVoucherMileage;if(parseFloat(p)>0){MiniCalculator.applyVoucherMileage(p)}}var m=b("#usedClubMileage");if(m.length>0){m=m.data().applyMobileMileage;if(parseFloat(m)>0){MiniCalculator.applyClubMileage(m)}}var h=b("usedOnlineReward");if(h.length>0){h=h.data().applyClubMileage;if(parseFloat(h)>0){MiniCalculator.applyClubMileage(h)}}},getLimitMileageAmount:function(){var d=0;if(b("select[name=limitMileageIds]")){var c=b("select[name=limitMileageIds] option:selected").index();if(c>0){var e=b("select[name=limitMileageIds] option:selected").data();d=parseFloat(e.amount)}}return d},getLimitAllianceMileageAmount:function(){var d=0;if(b("select[name=limitAllianceMileageIds]")){var c=b("select[name=limitAllianceMileageIds] option:selected").index();if(c>0){var e=b("select[name=limitAllianceMileageIds] option:selected").data();d=parseFloat(e.amount)}}return d},searchFlightOrShip:function(){var j=[b("#airport"),b("#date_year"),b("#date_month"),b("#date_day")];var c=b.ShillaCheckout.validateCheck2({obj:j});if(c==false){return false}if(b("#fixDepartureInfo").length>0&&b("#fixDepartureInfo").val()=="true"){alert("参与EMS服务顾客不得随意更改出境信息。");return}var d;var i=b("#airport").val();var h=b(":input:hidden[name=depDate]").val();var f="";var g="";if(b("#airport1").val()!=""){f=b("#airport1").val().substring(0,2);g=b("#airport1").val().substring(2)}var e=b.ShillaCheckout.getUrl("flightInfo");b.ShillaCheckout.checkoutFlightSchedule({departurePlaceCode:i,departureDate:h,airLine:f,flightName:g,url:e,callback:function(k){if(k){if(i=="P"||i=="U"||i=="I"){b("#layer-searchship").html(k);popOpen(b("#layer-searchship"))}else{b("#layer-searchflight").html(k);popOpen(b("#layer-searchflight"))}}}})},initUserInfoSection:function(){},showSelPayWay:function(c){if(b("#paywayinfo_"+c).length>0){b("#paywayinfo_"+c).show()}},hideAll:function(c){b("input[name=selPayCardChk]").each(function(){if(c!=b(this).val()){if(b("#paywayinfo_"+b(this).data().paywaycode).length>0){b("#paywayinfo_"+b(this).data().paywaycode).hide()}}})},initPaymentMethodSection:function(){b("input:radio[name=selPayCardChk]:first").prop("checked",true);var d=b("input:radio[name=selPayCardChk]").is(":checked");if(d){var c=b("input:radio[name=selPayCardChk]:checked").data();b(":input:hidden[name=payWayCode]").val(c.paywaycode);b("#pay_info").html(b.ShillaCheckout.getPaywayLabel(c.paywaycode));b.ShillaCheckout.hideAll(c.paywaycode);b.ShillaCheckout.showSelPayWay(c.paywaycode)}b(document).on("touchstart click","input:radio[name=selPayCardChk]",function(){var g=b("input:radio[name=selPayCardChk]:checked").data();b(":input:hidden[name=payWayCode]").val(g.paywaycode);b("#pay_info").html(b.ShillaCheckout.getPaywayLabel(g.paywaycode));b.ShillaCheckout.hideAll(g.paywaycode);b.ShillaCheckout.showSelPayWay(g.paywaycode);var f=true;var e=g.code.replace("cn-","");if(e!="creditCard"&&e!="global-creditCard"&&e!="krp-global-creditCard"){b("#korCreditCard").prop("disabled",true);b("#cardInstallment").hide();b("#cardInstallment").prop("disabled",true);b("#cardInstallment option:eq(0)").attr("selected","selected");b("#intrCreditCard").prop("disabled",true);b("#intrKrpCreditCard").prop("disabled",true)}else{if(e=="creditCard"){b("#korCreditCard").prop("disabled",false);b("#cardInstallment").show();b("#cardInstallment").prop("disabled",false);b("#intrCreditCard").prop("disabled",true);b("#intrKrpCreditCard").prop("disabled",true);if(b("#korCreditCard").val()!=""){f=true}else{f=false}}else{if(e=="global-creditCard"){b("#korCreditCard").prop("disabled",true);b("#cardInstallment").hide();b("#cardInstallment").prop("disabled",true);b("#cardInstallment option:eq(0)").attr("selected","selected");b("#intrCreditCard").prop("disabled",false);b("#intrKrpCreditCard").prop("disabled",true);if(b("#intrCreditCard").val()!=""){f=true}else{f=false}}else{b("#korCreditCard").prop("disabled",true);b("#cardInstallment").hide();b("#cardInstallment").prop("disabled",true);b("#cardInstallment option:eq(0)").attr("selected","selected");b("#intrCreditCard").prop("disabled",true);b("#intrKrpCreditCard").prop("disabled",false);if(b("#intrKrpCreditCard").val()!=""){f=true}else{f=false}}}}if(e=="alipay-plus"||e=="alipay-plus2"){if(b("#walletBrandName option").length<=1){b.ShillaSubmit.easypayAlipayPaymentMethod()}b("#walletBrandName").prop("disabled",false)}else{b("#walletBrandName").prop("disabled",true);b("#walletBrandName option:eq(0)").attr("selected","selected")}if(f){MiniCalculator.expectedSaveClubMileage()}})},applyPassport:function(c,d){b("#psprtNo").val(c);b("#psprtExprDate").val(d);alert(b.ShillaCheckout.getMessage("PA021"));popClose(b("#layer-passportinfo"))},updatePassport:function(f,e,g){var c=false;var d=b.ShillaCheckout.getUrl("updatePassport");b.ajax({type:"POST",url:d,dataType:"json",data:{CSRFToken:f,psprtNo:e,psprtExprDate:g},async:false,success:function(h){if(h>0){c=true}},error:function(j,h,i){},beforeSend:function(h){},complete:function(h,i){}});return c},resetDisount:function(){b("#totalSavedMileageUsedY").removeAttr("checked");b("#totalUsedUnlimitMileage").val("0");b("#maxUnlimitMileage").removeAttr("checked");b("select[name=duplicateMileageIds] option:eq(0)").attr("selected","selected");b("select[name=limitMileageIds] option:eq(0)").attr("selected","selected");b("select[name=limitAllianceMileageIds] option:eq(0)").attr("selected","selected");b("select[name=additionalMileageId] option:eq(0)").attr("selected","selected");b("#usedMobileMileage").val("0");b("input:checkbox[id=totalUsedMobileMileage]").prop("checked",false);b("#usedClubMileage").val("0");b("input:checkbox[id=totalUsedClubMileage]").prop("checked",false);b("#usedOnlineReward").val("0");b("input:checkbox[id=totalUsedOnlineReward]").prop("checked",false)},strLengthCheck:function(c,d){if(typeof c!="string"){return false}if(c.length>d){return false}return true},validateUnlimiMileageVal:function(g){var f=g.val();var e=/^[0-9]+(.[0-9]{1,2})?$/;var c=e.test(f);if(!c){var d=f.indexOf(".")+3;f=f.substring(0,d);g.val(f)}},validationUnlimitMileage:function(f){var e=f.val();if(!b.isNumeric(e)){alert(b.ShillaCheckout.getMessage("PA101"));b("#maxUnlimitMileage").removeAttr("checked");f.val("0");return false}var c=b("#availableGeneralUnlimtMileage1").val();e=parseFloat(e);c=parseFloat(c);if(e>c){var d=b.ShillaCheckout.getMessage("PA050");alert(d);b("#maxUnlimitMileage").removeAttr("checked");f.val("0");return false}return true},depPlaceCodeChange:function(g){var e=b.extend({obj:null},g||{});var f=e.obj;if(f.val()=="W"){b("input:radio[name=transit]").removeAttr("disabled");b("#viaPlaceCode").removeAttr("disabled")}else{if(f.val()=="P"||f.val()=="U"||f.val()=="I"){b(":input:radio[name=transit]:first").prop("checked",true);b(":input:radio[name=transit]").attr("disabled","disabled");b("#viaPlaceCode").attr("disabled","disabled");var d=b(":input:radio[name=transit]:checked").val();b(":input:hidden[name=directYn]").val(d)}else{b(":input:radio[name=transit]").removeAttr("disabled");b("#viaPlaceCode").removeAttr("disabled")}}if(f.val()!="W"){b(":input:hidden[name=deliveryPlaceCode]").val("")}b(":input:hidden[name=depPlaceCode]").val(f.val());b("#airport1").val("");b(":input:hidden[name=flightNo]").val("");var c=b(f).find("option:selected").text();b("#displayDepPlace").text(c)},setDepartureInfo:function(h){var e=b.extend({departureDate:"",departureTime:"",departurePlaceCode:"",departureFlightNo:"",viaPlaceCode:"",arrivPlaceCode:"",isDirect:"",deliveryPlaceCode:""},h||{});b("select[name=depPlaceCode1]").val(e.departurePlaceCode);b(":input:hidden[name=depDate]").val(e.departureDate);b(":input:hidden[name=depTime]").val(e.departureTime);b(":input:hidden[name=depPlaceCode]").val(e.departurePlaceCode);b(":input:hidden[name=flightNo]").val(e.departureFlightNo);b(":input:hidden[name=directYn]").val(e.isDirect);b(":input:hidden[name=viaPlaceCode]").val(e.viaPlaceCode);b(":input:hidden[name=arrivPlaceCode]").val(e.arrivPlaceCode);b(":input:hidden[name=deliveryPlaceCode]").val(e.deliveryPlaceCode);if(e.departurePlaceCode=="W"){b(":input:radio[name=transit]").removeAttr("disabled");b("#viaPlaceCode").removeAttr("disabled")}else{b(":input:hidden[name=deliveryPlaceCode]").val("")}var d=e.departureDate;var g=e.departureTime;if(d){b("#date_year").val(d.substr(0,4));b("#date_month").val(d.substr(4,2));b("#date_day").val(d.substr(6))}if(g){var f=g.substr(0,2)+":"+g.substr(2,2);b("#time_set1").val(f);var c=[];c.push(g.substr(0,2)+"点 ");c.push(g.substr(2,2)+"分 出发");b(".time_tip").html(c.join(""));b(".time_tip").show()}},validateCheck:function(f){var e=b.extend({obj:[]},f||{});var d;if(f){d=e.obj}var c=true;b.each(d,function(g,i){if(!i.val()){var h;if(i.attr("id")=="airport"){h=b.ShillaCheckout.getMessage("PA014")}else{if(i.attr("id")=="date_set1"||i.attr("id")=="time_set1"){h=b.ShillaCheckout.getMessage("PA013")}else{if(i.attr("id")=="airport1"){h=b.ShillaCheckout.getMessage("PA015")}}}alert(h);c=false;return false}});return c},validateCheck2:function(f){var e=b.extend({obj:[]},f||{});var d;if(f){d=e.obj}var c=true;b.each(d,function(g,i){if(!i.val()){var h;if(i.attr("id")=="airport"){h=b.ShillaCheckout.getMessage("PA014")}else{if(i.attr("id")=="date_year"||i.attr("id")=="date_month"||i.attr("id")=="date_day"||i.attr("id")=="time_set1"){h=b.ShillaCheckout.getMessage("PA013")}else{if(i.attr("id")=="airport1"){h=b.ShillaCheckout.getMessage("PA015")}}}alert(h);c=false;return false}});return c},getCouponList:function(e){var d=b.extend({callback:null},e||{});var c=b.ShillaCheckout.getUrl("couponList");b.ajax({type:"GET",url:c,dataType:"html",contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:{},success:function(f){},error:function(h,f,g){},beforeSend:function(f){},complete:function(f,g){}}).done(function(f){if(b.isFunction(d.callback)){d.callback(f)}})},getMyDepatureInfo:function(d){var c=b.extend({url:"",callback:null},d||{});b.ajax({type:"GET",url:c.url,dataType:"html",data:{},success:function(e){},error:function(g,e,f){},beforeSend:function(e){},complete:function(e,f){}}).done(function(e){if(b.isFunction(c.callback)){c.callback(e)}})},checkoutFlightSchedule:function(d){var c=b.extend({departurePlaceCode:"",departureDate:"",airLine:"",flightName:"",url:"",type:"GET",callback:null},d||{});b.ajax({type:c.type,url:c.url,dataType:"html",data:{departurePlaceCode:c.departurePlaceCode,departureDate:c.departureDate,airLine:c.airLine,flightName:c.flightName},success:function(e){if(typeof c.callback==="function"){c.callback(e)}},error:function(g,e,f){},beforeSend:function(e){},complete:function(e,f){}}).done(function(e){if(b.isFunction(c.callback)){c.callback(e)}})},checkPattern:function(d,c){switch(c){case"NUM":pattern=/^[0-9]+$/;break;case"PASSPORT":pattern=/^[A-Z]{2}([0-9]{3}|[0-9]{4})$/;break;default:return false}return pattern.test(d)},applyCouponDcAmt:function(c,d,e){b("#usdCpnDcAmt_"+c).val(d);b("#wonCpnDcAmt_"+c).val(e)},removeProductCoupon:function(c){var d=b("#appliedProductCoupon").data();MiniCalculator.applyProductCoupon(c,false);b("#productCoupon1").html("")},removeCartCoupon:function(d){var c=b("#appliedCartCoupon");MiniCalculator.applyCartCoupon(c);b.ShillaCheckout.resetDisount();b("#cartCoupon1").html("")},validatePassportNumber:function(d){var c=b.ShillaSubmit.getUrl("passportPatternUrl");var e=false;b.ajax({url:c,type:"GET",dataType:"json",data:{psprtNo:d,nationalityCode:b.ShillaSubmit.options.nationalityCode},async:false,error:function(){alert("故障发生在与服务器的通信。")},success:function(f){if(f.result=="success"){e=true}else{e=false}}});return e},checkValidatePassportCnt:function(e){var d=b.ShillaSubmit.getUrl("passportUrl");var c=b("#psprtNo1").val();if(c!="undefined"&&c!=""){b.ajax({url:d,type:"POST",dataType:"json",async:true,data:{psprtNo:c},error:function(h,f,g){},success:function(f){if(f>0){b("#alreadyPsprtNo").show()}else{b("#alreadyPsprtNo").hide()}}}).done(function(f){if(typeof callback==="function"){callback(f)}})}},releaseCoupon:function(){var d=b("#appliedProductCoupon").data();if(typeof(d)!="undefined"){MiniCalculator.applyProductCoupon(d,false)}b("#productCoupon1").html("");var c=b("#appliedCartCoupon");MiniCalculator.applyCartCoupon(c);b("#cartCoupon1").html("")},applyCoupon:function(e,f){if(e.length>0){for(var j=0;j<e.length;j++){MiniCalculator.applyProductCoupon(e[j],true);var d=b("#appliedProductCoupon");d.data("couponid",e[j].couponid);d.data("dctype",e[j].dctype);d.data("dcfixamt",e[j].dcfixamt);d.data("dcfixrate",e[j].dcfixrate);d.data("dcprodlist",e[j].dcprodlist);d.data("offername",e[j].offername)}}if(typeof(f)!="undefined"){MiniCalculator.applyCartCoupon(f)}b.ShillaCheckout.resetDisount();var n=[];var p='<li name="couponlist" id="productCoupon1"><span>';var l='<li name="couponlist" id="cartCoupon1"><span>';var h='</span><a href="#" class="ic_delete" onclick="$.ShillaCheckout.removeProductCoupon($(this).data());" data-couponid="';var c='</span><a href="#" class="ic_delete" id="cartCoupon1" onclick="$.ShillaCheckout.removeCartCoupon($(this).data());" data-couponid="';var o='"></a></li>';if(e){var g=[];b.each(e,function(i,r){g.push(r.productcode+"|"+r.couponid);var q=p+r.offername+h+r.couponid+o;n.push(q)})}if(f){var m=l+f.offername+c+f.couponid+o;n.push(m);var k=b("#appliedCartCoupon");k.data("couponid",f.couponid);k.data("dctype",f.dctype);k.data("dcfixamt",f.dcfixamt);k.data("dcfixrate",f.dcfixrate);k.data("dcprodlist",f.dcprodlist);k.data("offername",f.offername)}b("#applyProductCoupon").html(n.join(""))},popupViewRecept:function(c){var g=b("input[name=transId]").val();var f=b("input[name=provider]").val();var e=b("input[name=ref]").val();var j=parseInt(b("input[name=paymentAmt]").val());var i=b("input[name=orderNo]").val();if(g!=""){if(f=="KICC"){var d=b("#form1");window.open("","MEMB_POP_RECEIPT","toolbar=0,scroll=1,menubar=0,status=0,resizable=0,width=380,height=700");b(d).find("input[name=controlNo]").val(g);b(d).find("input[name=payment]").val("");b(d).attr("action",c);b(d).attr("target","MEMB_POP_RECEIPT");b(d).submit()}if(f=="KRP"){var h=c+"?transid="+g+"&ref="+e;window.open(h,"MEMB_POP_RECEIPT","toolbar=0,scroll=1,menubar=0,status=0,resizable=0,width=710,height=740")}if(f=="KCP"){var h=c+"&tno="+g+"&order_no="+i+"&trade_mony="+j;window.open(h,"MEMB_POP_RECEIPT","toolbar=0,scroll=1,menubar=0,status=0,resizable=0,width=710,height=740")}}},checkDomesticFlight:function(f,g){var c=b("#airport").val();var e=f+g;var d={isDomesticFlight:false,message:""};return d},orderDistributes:function(){var l=null;var d=b("#orderForm").find("input[name=selPayCardChk]").is(":checked");if(d){b("#orderForm").find("input[name=cardIssueCmpyCode]").val("");b("#orderForm").find("input[name=cardIssueCmpyName]").val("");var i=b("#orderForm").find("input[name=usdPaySumAmt]").val();var c=b("#orderForm").find("input[name=wonPaySumAmt]").val();var e=b("#orderForm").find("input[name=selPayCardChk]:checked").data();var g=e.code.replace("cn-","");b("#orderForm").find("input[name=payWayCode]").val(e.paywaycode);switch(g){case"unionpay":b("#orderForm").find("input[name=cardIssueCmpyCode]").val("081");b("#orderForm").find("input[name=cardIssueCmpyName]").val("은련카드");break;case"unionpay-noncert":b("#orderForm").find("input[name=tenPayMethod]").val("P002");b("#orderForm").find("input[name=cardIssueCmpyCode]").val("UBC");b("#orderForm").find("input[name=cardIssueCmpyName]").val("UnionPay");break;case"tenpay":b("#orderForm").find("input[name=tenPayMethod]").val("P004");b("#orderForm").find("input[name=cardIssueCmpyCode]").val("TEN");b("#orderForm").find("input[name=cardIssueCmpyName]").val("Tenpay");break;case"wechatpay":b("#orderForm").find("input[name=tenPayMethod]").val("P142");b("#orderForm").find("input[name=cardIssueCmpyCode]").val("WXN");b("#orderForm").find("input[name=cardIssueCmpyName]").val("WeChatPay");break;case"wechatpay-hana":b("#orderForm").find("input[name=tenPayMethod]").val("PAYMENT");b("#orderForm").find("input[name=cardIssueCmpyCode]").val("WXH");b("#orderForm").find("input[name=cardIssueCmpyName]").val("WeChatPay-HANA");break;case"wechatpay-smartro":b("#orderForm").find("input[name=tenPayMethod]").val("PAYMENT");b("#orderForm").find("input[name=cardIssueCmpyCode]").val("WXS");b("#orderForm").find("input[name=cardIssueCmpyName]").val("WeChatPay-Smartro");break;case"wechatpay-tnu":b("#orderForm").find("input[name=cardIssueCmpyCode]").val("WXT");b("#orderForm").find("input[name=cardIssueCmpyName]").val("WeChatPay-TnU");break;case"paypal":b("#orderForm").find("input[name=tenPayMethod]").val("P001");b("#orderForm").find("input[name=cardIssueCmpyCode]").val("PPL");b("#orderForm").find("input[name=cardIssueCmpyName]").val("Paypal");break;case"alipay":case"alipay-direct":b("#orderForm").find("input[name=tenPayMethod]").val("P003");b("#orderForm").find("input[name=cardIssueCmpyCode]").val("ALP");b("#orderForm").find("input[name=cardIssueCmpyName]").val("Alipay");break;case"alipay-KICC":b("#orderForm").find("input[name=cardIssueCmpyCode]").val("ALP");b("#orderForm").find("input[name=cardIssueCmpyName]").val("Alipay-KICC");break;case"global-creditCard":if(b("#intrCreditCard option:selected").val()!=""){b("#orderForm").find("input[name=cardIssueCmpyCode]").val(b("#intrCreditCard option:selected").val());b("#orderForm").find("input[name=cardIssueCmpyName]").val(b("#intrCreditCard option:selected").text());b("#orderForm").find("input[name=reqType]").val("2")}break;case"krp-global-creditCard":if(b("#intrKrpCreditCard option:selected").val()!=""){var h=b("#intrKrpCreditCard option:selected").data();b("#orderForm").find("input[name=tenPayMethod]").val(h.tenpaymethod);b("#orderForm").find("input[name=cardIssueCmpyCode]").val(b("#intrKrpCreditCard option:selected").val());b("#orderForm").find("input[name=cardIssueCmpyName]").val("자국환")}break;case"creditCard":if(b("#korCreditCard option:selected").val()!=""){b("#orderForm").find("input[name=cardIssueCmpyCode]").val(b("#korCreditCard option:selected").val());b("#orderForm").find("input[name=cardIssueCmpyName]").val(b("#korCreditCard option:selected").text());b("#orderForm").find("input[name=reqType]").val("3")}break;case"quickpay":b("#orderForm").find("input[name=cardIssueCmpyCode]").val("081");b("#orderForm").find("input[name=cardIssueCmpyName]").val("은련카드");break;case"bestpay":b("#orderForm").find("input[name=tenPayMethod]").val("P010");b("#orderForm").find("input[name=cardIssueCmpyCode]").val("BSP");b("#orderForm").find("input[name=cardIssueCmpyName]").val("BestPay");break}}var j=b("#orderForm");if(j.length<=0){return l}var k=b.ShillaCheckout.getUrl("distributeOrderUrl");b.ajax({url:k,type:"POST",data:j.serialize(),timeout:5000,async:false,error:function(n,f,m){alert("서버와의 통신에 장애가 발생하였습니다.")},success:function(f){if("true"==f.isSuccess){l=f.entries}else{var m=b("<div>").html(f.message).text().replace(/\\n/g,"\n");alert(m)}}});return l}}})(jQuery);function crImeModeOnlyNum(a){a.value=a.value.replace(/[^0-9]/g,"")}function validate_captcha_chk(){popOpen($("#layer-captchaPopup"))};