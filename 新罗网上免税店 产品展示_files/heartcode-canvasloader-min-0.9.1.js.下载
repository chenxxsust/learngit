(function(s){var h=function(a,f){typeof f=="undefined"&&(f={});this.init(a,f)},l=h.prototype,d,c=["canvas","vml"],i=["oval","spiral","square","rect","roundRect"],r=/^\#([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/,z=navigator.appVersion.indexOf("MSIE")!==-1&&parseFloat(navigator.appVersion.split("MSIE")[1])===8?true:false,j=!!document.createElement("canvas").getContext,b=true,e=function(f,n,k){var f=document.createElement(f),m;for(m in k){f[m]=k[m]}typeof n!=="undefined"&&n.appendChild(f);return f},g=function(f,m){for(var k in m){f.style[k]=m[k]}return f},B=function(f,m){for(var k in m){f.setAttribute(k,m[k])}return f},A=function(f,n,k,m){f.save();f.translate(n,k);f.rotate(m);f.translate(-n,-k);f.beginPath()};l.init=function(f,o){if(typeof o.safeVML==="boolean"){b=o.safeVML}try{this.mum=document.getElementById(f)!==void 0?document.getElementById(f):document.body}catch(k){this.mum=document.body}o.id=typeof o.id!=="undefined"?o.id:"canvasLoader";this.cont=e("div",this.mum,{id:o.id});if(j){d=c[0],this.can=e("canvas",this.cont),this.con=this.can.getContext("2d"),this.cCan=g(e("canvas",this.cont),{display:"none"}),this.cCon=this.cCan.getContext("2d")}else{d=c[1];if(typeof h.vmlSheet==="undefined"){document.getElementsByTagName("head")[0].appendChild(e("style"));h.vmlSheet=document.styleSheets[document.styleSheets.length-1];var n=["group","oval","roundrect","fill"],m;for(m in n){h.vmlSheet.addRule(n[m],"behavior:url(#default#VML); position:absolute;")}}this.vml=e("group",this.cont)}this.setColor(this.color);this.draw();g(this.cont,{display:"none"})};l.cont={};l.can={};l.con={};l.cCan={};l.cCon={};l.timer={};l.activeId=0;l.diameter=40;l.setDiameter=function(a){this.diameter=Math.round(Math.abs(a));this.redraw()};l.getDiameter=function(){return this.diameter};l.cRGB={};l.color="#000000";l.setColor=function(a){this.color=r.test(a)?a:"#000000";this.cRGB=this.getRGB(this.color);this.redraw()};l.getColor=function(){return this.color};l.shape=i[0];l.setShape=function(a){for(var f in i){if(a===i[f]){this.shape=a;this.redraw();break}}};l.getShape=function(){return this.shape};l.density=40;l.setDensity=function(a){this.density=b&&d===c[1]?Math.round(Math.abs(a))<=40?Math.round(Math.abs(a)):40:Math.round(Math.abs(a));if(this.density>360){this.density=360}this.activeId=0;this.redraw()};l.getDensity=function(){return this.density};l.range=1.3;l.setRange=function(a){this.range=Math.abs(a);this.redraw()};l.getRange=function(){return this.range};l.speed=2;l.setSpeed=function(a){this.speed=Math.round(Math.abs(a))};l.getSpeed=function(){return this.speed};l.fps=24;l.setFPS=function(a){this.fps=Math.round(Math.abs(a));this.reset()};l.getFPS=function(){return this.fps};l.getRGB=function(a){a=a.charAt(0)==="#"?a.substring(1,7):a;return{r:parseInt(a.substring(0,2),16),g:parseInt(a.substring(2,4),16),b:parseInt(a.substring(4,6),16)}};l.draw=function(){var C=0,y,D,x,w,u,o,p,f=this.density,E=Math.round(f*this.range),n,t,m=0;t=this.cCon;var v=this.diameter;if(d===c[0]){t.clearRect(0,0,1000,1000);B(this.can,{width:v,height:v});for(B(this.cCan,{width:v,height:v});C<f;){n=C<=E?1-1/E*C:n=0;o=270-360/f*C;p=o/180*Math.PI;t.fillStyle="rgba("+this.cRGB.r+","+this.cRGB.g+","+this.cRGB.b+","+n.toString()+")";switch(this.shape){case i[0]:case i[1]:y=v*0.07;w=v*0.47+Math.cos(p)*(v*0.47-y)-v*0.47;u=v*0.47+Math.sin(p)*(v*0.47-y)-v*0.47;t.beginPath();this.shape===i[1]?t.arc(v*0.5+w,v*0.5+u,y*n,0,Math.PI*2,false):t.arc(v*0.5+w,v*0.5+u,y,0,Math.PI*2,false);break;case i[2]:y=v*0.12;w=Math.cos(p)*(v*0.47-y)+v*0.5;u=Math.sin(p)*(v*0.47-y)+v*0.5;A(t,w,u,p);t.fillRect(w,u-y*0.5,y,y);break;case i[3]:case i[4]:D=v*0.3,x=D*0.27,w=Math.cos(p)*(x+(v-x)*0.13)+v*0.5,u=Math.sin(p)*(x+(v-x)*0.13)+v*0.5,A(t,w,u,p),this.shape===i[3]?t.fillRect(w,u-x*0.5,D,x):(y=x*0.55,t.moveTo(w+y,u-x*0.5),t.lineTo(w+D-y,u-x*0.5),t.quadraticCurveTo(w+D,u-x*0.5,w+D,u-x*0.5+y),t.lineTo(w+D,u-x*0.5+x-y),t.quadraticCurveTo(w+D,u-x*0.5+x,w+D-y,u-x*0.5+x),t.lineTo(w+y,u-x*0.5+x),t.quadraticCurveTo(w,u-x*0.5+x,w,u-x*0.5+x-y),t.lineTo(w,u-x*0.5+y),t.quadraticCurveTo(w,u-x*0.5,w+y,u-x*0.5))}t.closePath();t.fill();t.restore();++C}}else{g(this.cont,{width:v,height:v});g(this.vml,{width:v,height:v});switch(this.shape){case i[0]:case i[1]:p="oval";y=140;break;case i[2]:p="roundrect";y=120;break;case i[3]:case i[4]:p="roundrect",y=300}D=x=y;w=500-x;for(u=-x*0.5;C<f;){n=C<=E?1-1/E*C:n=0;o=270-360/f*C;switch(this.shape){case i[1]:D=x=y*n;w=500-y*0.5-y*n*0.5;u=(y-y*n)*0.5;break;case i[0]:case i[2]:z&&(u=0,this.shape===i[2]&&(w=500-x*0.5));break;case i[3]:case i[4]:D=y*0.95,x=D*0.28,z?(w=0,u=500-x*0.5):(w=500-D,u=-x*0.5),m=this.shape===i[4]?0.6:0}t=B(g(e("group",this.vml),{width:1000,height:1000,rotation:o}),{coordsize:"1000,1000",coordorigin:"-500,-500"});t=g(e(p,t,{stroked:false,arcSize:m}),{width:D,height:x,top:u,left:w});e("fill",t,{color:this.color,opacity:n});++C}}this.tick(true)};l.clean=function(){if(d===c[0]){this.con.clearRect(0,0,1000,1000)}else{var a=this.vml;if(a.hasChildNodes()){for(;a.childNodes.length>=1;){a.removeChild(a.firstChild)}}}};l.redraw=function(){this.clean();this.draw()};l.reset=function(){typeof this.timer==="number"&&(this.hide(),this.show())};l.tick=function(k){var m=this.con,n=this.diameter;k||(this.activeId+=360/this.density*this.speed);d===c[0]?(m.clearRect(0,0,n,n),A(m,n*0.5,n*0.5,this.activeId/180*Math.PI),m.drawImage(this.cCan,0,0,n,n),m.restore()):(this.activeId>=360&&(this.activeId-=360),g(this.vml,{rotation:this.activeId}))};l.show=function(){if(typeof this.timer!=="number"){var f=this;this.timer=self.setInterval(function(){f.tick()},Math.round(1000/this.fps));g(this.cont,{display:"block"})}};l.hide=function(){typeof this.timer==="number"&&(clearInterval(this.timer),delete this.timer,g(this.cont,{display:"none"}))};l.kill=function(){var f=this.cont;typeof this.timer==="number"&&this.hide();d===c[0]?(f.removeChild(this.can),f.removeChild(this.cCan)):f.removeChild(this.vml);for(var k in this){delete this[k]}};s.CanvasLoader=h})(window);